# ë¨¸ì‹ ëŸ¬ë‹ ìºê¸€ íƒ€ì´íƒ€ë‹‰ ê²½ì§„ëŒ€íšŒ(competition)


![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-03-24 á„‹á…©á„’á…® 11 10 19](https://github.com/user-attachments/assets/235e0f84-a6f6-42c0-9ccd-472f8af387a5)

ë“±ìˆ˜ëŠ” 745ë“±

![image](https://github.com/user-attachments/assets/497999ae-6156-4f92-9fc9-4312eb665b52)

Titanic ìƒì¡´ì ì˜ˆì¸¡ ê²½ì§„ëŒ€íšŒ ë„ì „ê¸° ğŸš¢

1. ê°œìš”

Kaggleì˜ "Titanic - Machine Learning from Disaster" ê²½ì§„ëŒ€íšŒëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì…ë¬¸ìë“¤ì´ ë°ì´í„° ë¶„ì„ê³¼ ëª¨ë¸ë§ì„ ì—°ìŠµí•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” TensorFlow Decision Forests(TF-DF)ë¥¼ í™œìš©í•˜ì—¬ íƒ€ì´íƒ€ë‹‰ ìƒì¡´ì ì˜ˆì¸¡ ëª¨ë¸ì„ ë§Œë“¤ê³  Kaggleì— ì œì¶œí•œ ê³¼ì •ì„ ê³µìœ í•˜ê² ìŠµë‹ˆë‹¤.

2. ë¬¸ì œ í•´ê²° ê³¼ì •

2.1 ë°ì´í„° íƒìƒ‰ ë° ì´í•´

ë¨¼ì € ì œê³µëœ train.csvì™€ test.csv ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì–´ë–¤ íŠ¹ì„±ì´ ì¤‘ìš”í•œì§€ íŒŒì•…í–ˆìŠµë‹ˆë‹¤.

Survivedê°€ ì˜ˆì¸¡í•´ì•¼ í•˜ëŠ” ëª©í‘œ ë³€ìˆ˜(0: ì‚¬ë§, 1: ìƒì¡´)

Pclass, Sex, Age, SibSp, Parch, Fare, Embarked ë“±ì´ ì¤‘ìš”í•œ íŠ¹ì„±ìœ¼ë¡œ ì˜ˆìƒë¨

ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•˜ëŠ” ì»¬ëŸ¼(Age, Embarked, Fare)ì„ ì²˜ë¦¬í•´ì•¼ í•¨

```python
import numpy as np
import pandas as pd
```
```python
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
train = pd.read_csv("train.csv")
test = pd.read_csv("test.csv")
```
```python
# ë°ì´í„° ì •ë³´ í™•ì¸
print(train.info())
print(train.describe())
```
2.2 ë°ì´í„° ì „ì²˜ë¦¬

ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ë†’ì´ê¸° ìœ„í•´ ê²°ì¸¡ì¹˜ë¥¼ ì²˜ë¦¬í•˜ê³  ë²”ì£¼í˜• ë°ì´í„°ë¥¼ ë³€í™˜í•˜ì˜€ìŠµë‹ˆë‹¤.
```python
# ê²°ì¸¡ì¹˜ ì²˜ë¦¬
train.fillna({"Age": train["Age"].median(), "Embarked": "S"}, inplace=True)
test.fillna({"Age": test["Age"].median(), "Fare": test["Fare"].median()}, inplace=True)
```
```python
# ë²”ì£¼í˜• ë°ì´í„° ë³€í™˜
train["Sex"] = train["Sex"].map({"male": 0, "female": 1})
test["Sex"] = test["Sex"].map({"male": 0, "female": 1})

train["Embarked"] = train["Embarked"].map({"S": 0, "C": 1, "Q": 2})
test["Embarked"] = test["Embarked"].map({"S": 0, "C": 1, "Q": 2})
```
2.3 TensorFlow Decision Forests ëª¨ë¸ ì ìš©

ì˜ì‚¬ê²°ì • íŠ¸ë¦¬ ê¸°ë°˜ì˜ ê°•ë ¥í•œ ë¨¸ì‹ ëŸ¬ë‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ TensorFlow Decision Forestsë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜ˆì¸¡ ëª¨ë¸ì„ êµ¬ì¶•í•˜ì˜€ìŠµë‹ˆë‹¤.
```python
import tensorflow_decision_forests as tfdf
import tensorflow as tf
```
```python
# ë°ì´í„°ë¥¼ TensorFlow ë°ì´í„°ì…‹ìœ¼ë¡œ ë³€í™˜
train_dataset = tfdf.keras.pd_dataframe_to_tf_dataset(train, task=tfdf.keras.Task.CLASSIFICATION, label="Survived")
test_dataset = tfdf.keras.pd_dataframe_to_tf_dataset(test, task=tfdf.keras.Task.CLASSIFICATION)
```
```python
# ëª¨ë¸ ìƒì„± ë° í•™ìŠµ
model = tfdf.keras.GradientBoostedTreesModel()
model.fit(train_dataset)
```
2.4 ëª¨ë¸ ì˜ˆì¸¡ ë° Kaggle ì œì¶œ

ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ í…ŒìŠ¤íŠ¸ ë°ì´í„°ì— ëŒ€í•œ ì˜ˆì¸¡ì„ ìˆ˜í–‰í•˜ê³  Kaggleì— ì œì¶œí•  íŒŒì¼ì„ ìƒì„±í•˜ì˜€ìŠµë‹ˆë‹¤.
```python
# ì˜ˆì¸¡ ìˆ˜í–‰
predictions = model.predict(test_dataset)
```
```python
# ì œì¶œ íŒŒì¼ ìƒì„±
submission = pd.DataFrame({"PassengerId": test["PassengerId"], "Survived": predictions.flatten().astype(int)})
submission.to_csv("submission.csv", index=False)
```
6. ê²°ê³¼ ë° ì„±ê³¼

Kaggleì— ì œì¶œí•œ ê²°ê³¼, Public Score 0.80143ê¸°ë¡, ë“±ìˆ˜ 745ë“±

ìºê¸€ ì£¼í”¼í„° ë§í¬ : <https://www.kaggle.com/code/ysh1015/titanic-competition-w-tensorflow-decision-forests>
