# ë¨¸ì‹ ëŸ¬ë‹ ìºê¸€ íƒ€ì´íƒ€ë‹‰ ê²½ì§„ëŒ€íšŒ(competition)


![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2025-03-24 á„‹á…©á„’á…® 11 10 19](https://github.com/user-attachments/assets/235e0f84-a6f6-42c0-9ccd-472f8af387a5)

ë“±ìˆ˜ëŠ” 745ë“±

![image](https://github.com/user-attachments/assets/497999ae-6156-4f92-9fc9-4312eb665b52)

Titanic ìƒì¡´ì ì˜ˆì¸¡ ê²½ì§„ëŒ€íšŒ ë„ì „ê¸° ğŸš¢

1. ê°œìš”

Kaggleì˜ "Titanic - Machine Learning from Disaster" ê²½ì§„ëŒ€íšŒëŠ” ë¨¸ì‹ ëŸ¬ë‹ ì…ë¬¸ìë“¤ì´ ë°ì´í„° ë¶„ì„ê³¼ ëª¨ë¸ë§ì„ ì—°ìŠµí•  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤. ì´ë²ˆ í¬ìŠ¤íŠ¸ì—ì„œëŠ” TensorFlow Decision Forests(TF-DF)ë¥¼ í™œìš©í•˜ì—¬ íƒ€ì´íƒ€ë‹‰ ìƒì¡´ì ì˜ˆì¸¡ ëª¨ë¸ì„ ë§Œë“¤ê³  Kaggleì— ì œì¶œí•œ ê³¼ì •ì„ ê³µìœ í•˜ê² ìŠµë‹ˆë‹¤.

2. ë°ì´í„°ì…‹ ê°œìš”

íƒ€ì´íƒ€ë‹‰ ë°ì´í„°ëŠ” ìƒì¡´ ì—¬ë¶€(Survived)ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ì§€ë„ í•™ìŠµ ë¬¸ì œì…ë‹ˆë‹¤. ì£¼ìš” ì»¬ëŸ¼ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:

Pclass (ì¢Œì„ ë“±ê¸‰)

Sex (ì„±ë³„)

Age (ë‚˜ì´)

SibSp (ê°™ì´ íƒ‘ìŠ¹í•œ í˜•ì œ/ë°°ìš°ì ìˆ˜)

Parch (ê°™ì´ íƒ‘ìŠ¹í•œ ë¶€ëª¨/ìë…€ ìˆ˜)

Fare (íƒ‘ìŠ¹ ìš”ê¸ˆ)

Embarked (ì¶œë°œ í•­êµ¬)

3. ë°ì´í„° ì „ì²˜ë¦¬

ëª¨ë¸ í•™ìŠµ ì „ì— ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë° ë²”ì£¼í˜• ë°ì´í„° ë³€í™˜ì„ ìˆ˜í–‰í•˜ì˜€ìŠµë‹ˆë‹¤.

```python
import pandas as pd
```

# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
```python
train = pd.read_csv("train.csv")
test = pd.read_csv("test.csv")
```

# ê²°ì¸¡ì¹˜ ì²˜ë¦¬
```python
train.fillna({"Age": train["Age"].median(), "Embarked": "S"}, inplace=True)
test.fillna({"Age": test["Age"].median(), "Fare": test["Fare"].median()}, inplace=True)
```

# ë²”ì£¼í˜• ë°ì´í„° ë³€í™˜
```python
train["Sex"] = train["Sex"].map({"male": 0, "female": 1})
test["Sex"] = test["Sex"].map({"male": 0, "female": 1})
```

4. TensorFlow Decision Forests ëª¨ë¸ ì ìš©

TensorFlow Decision Forests(TF-DF)ëŠ” ì˜ì‚¬ê²°ì • íŠ¸ë¦¬ ê¸°ë°˜ ëª¨ë¸ì„ ì‰½ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.
```python
import tensorflow_decision_forests as tfdf
import tensorflow as tf
```

# ë°ì´í„° ë³€í™˜
```python
train_dataset = tfdf.keras.pd_dataframe_to_tf_dataset(train, task=tfdf.keras.Task.CLASSIFICATION, label="Survived")
test_dataset = tfdf.keras.pd_dataframe_to_tf_dataset(test, task=tfdf.keras.Task.CLASSIFICATION)
```

# ëª¨ë¸ ìƒì„± ë° í•™ìŠµ
```python
model = tfdf.keras.GradientBoostedTreesModel()
model.fit(train_dataset)
```

# ì˜ˆì¸¡ ìˆ˜í–‰
```python
predictions = model.predict(test_dataset)
```

5. Kaggle ì œì¶œ

ëª¨ë¸ì´ ìƒì„±í•œ ì˜ˆì¸¡ ê²°ê³¼ë¥¼ submission.csv íŒŒì¼ë¡œ ì €ì¥í•˜ê³  Kaggleì— ì œì¶œí•˜ì˜€ìŠµë‹ˆë‹¤.
```python
submission = pd.DataFrame({"PassengerId": test["PassengerId"], "Survived": predictions.flatten().astype(int)})
submission.to_csv("submission.csv", index=False)
```

6. ê²°ê³¼ ë° ì„±ê³¼

Kaggleì— ì œì¶œí•œ ê²°ê³¼, Public Score 0.80143ê¸°ë¡, ë“±ìˆ˜ 745ë“±

ìºê¸€ ì£¼í”¼í„° ë§í¬ : <https://www.kaggle.com/code/ysh1015/titanic-competition-w-tensorflow-decision-forests>
